<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.library.basic.usr.order.OrderMapper">

	<!-- 주문테이블 db 저장 -->
	<insert id="orderInsert" parameterType="OrderVO">

		<selectKey keyProperty="ord_code" resultType="Long"
			order="BEFORE">
			SELECT
			seq_ord_code.nextval
			FROM
			DUAL
		</selectKey>
		INSERT INTO
		order_table(
		ord_code,
		usr_id,
		ord_name,
		ord_addr_zipcode,
		ord_addr_basic,
		ord_addr_detail,
		ord_tel,
		ord_price,
		ord_desc
		)
		VALUES(
		#{ord_code},
		#{usr_id},
		#{ord_name},
		#{ord_addr_zipcode},
		#{ord_addr_basic},
		#{ord_addr_detail},
		#{ord_tel},
		#{ord_price},
		#{ord_desc}
		)
	</insert>
	
		<insert id="orderDetailInsert" parameterType="map">
	INSERT INTO order_detail_table (
        ord_code,
        book_bno,
        dt_amount,
        dt_price
    )
    SELECT
        #{ord_code},
        book_bno,
        cart_amount,
        cart_amount * #{book_deposit}
    FROM	
        cart_table
    WHERE
        usr_id = #{usr_id}
	
	</insert>


</mapper>